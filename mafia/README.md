# 텔레그램 마피아 게임 봇

이 프로젝트는 텔레그램에서 마피아 게임을 진행할 수 있는 봇을 구현한 것입니다. 다양한 역할과 게임 진행 기능을 제공합니다.

## 기능

- 다양한 역할 지원 (마피아, 탐정, 의사, 기자, 선동가, 시민, 연쇄 살인마, 숭배자, 큐피드, 도둑)
- 낮/밤 단계 자동 진행
- 투표 시스템
- 역할별 특수 능력 사용
- 유언 작성 기능
- 게임 설정 커스터마이징

## 설치 방법

1. 저장소를 클론합니다.
```bash
git clone https://github.com/yourusername/telegram-mafia-bot.git
cd telegram-mafia-bot
```

2. 필요한 패키지를 설치합니다.
```bash
pip install python-telegram-bot
```

3. 텔레그램 봇 토큰을 설정합니다.
```bash
export TELEGRAM_TOKEN="your_telegram_bot_token"
```

## 사용 방법

1. 봇을 실행합니다.
```bash
python mafia_bot/main.py
```

2. 텔레그램에서 봇을 그룹에 초대합니다.

3. 다음 명령어를 사용하여 게임을 시작합니다:
   - `/start` - 봇 시작 및 소개
   - `/help` - 도움말 표시
   - `/menu` - 메뉴 표시
   - `/open` - 새 게임 생성
   - `/join` - 게임 참가
   - `/leave` - 게임 나가기
   - `/game` - 게임 시작
   - `/stop` - 게임 중지
   - `/settings` - 게임 설정 변경

## 역할 설명

### 마피아팀
- **마피아**: 밤에 시민을 죽일 수 있습니다.
- **선동가**: 밤에 한 명을 선택하여 다음 날 투표 가중치를 2배로 만듭니다.

### 시민팀
- **시민**: 특별한 능력은 없지만 투표로 마피아를 찾아내야 합니다.
- **탐정**: 밤에 한 명을 조사하여 마피아 여부를 알 수 있습니다.
- **의사**: 밤에 한 명을 선택하여 마피아의 공격으로부터 보호합니다.
- **기자**: 밤에 한 명을 선택하여 역할을 알아낼 수 있습니다.

### 중립팀
- **연쇄 살인마**: 밤에 한 명을 죽일 수 있으며, 모든 사람이 죽으면 승리합니다.
- **숭배자**: 밤에 한 명을 선택하여 자신의 승리 조건으로 삼습니다.
- **큐피드**: 첫 밤에 두 명을 연인으로 만들며, 연인이 살아남으면 승리합니다.
- **도둑**: 첫 밤에 한 명의 역할을 훔쳐 그 역할이 됩니다.

## 게임 진행

1. 게임 생성: `/open` 명령어로 새 게임을 생성합니다.
2. 참가: 플레이어들이 `/join` 명령어로 게임에 참가합니다.
3. 게임 시작: `/game` 명령어로 게임을 시작합니다.
4. 역할 배정: 각 플레이어에게 역할이 무작위로 배정됩니다.
5. 게임 진행: 낮과 밤이 번갈아가며 진행됩니다.
   - 낮: 토론 후 투표로 한 명을 처형합니다.
   - 밤: 각 역할별 특수 능력을 사용합니다.
6. 게임 종료: 승리 조건을 달성한 팀이 승리합니다.
   - 마피아팀: 마피아 수가 시민 수 이상이 되면 승리
   - 시민팀: 모든 마피아를 처형하면 승리
   - 중립팀: 각자의 승리 조건을 달성하면 승리

## 프로젝트 구조

```
mafia_bot/
├── roles/
│   ├── base_role.py - 기본 역할 클래스
│   ├── mafia_roles.py - 마피아 역할 클래스
│   ├── citizen_roles.py - 시민 역할 클래스
│   └── neutral_roles.py - 중립 역할 클래스
├── game/
│   ├── __init__.py - 게임 초기화 모듈
│   ├── player.py - 플레이어 클래스
│   ├── role_manager.py - 역할 관리자
│   ├── phase_manager.py - 게임 단계 관리자
│   └── game_manager.py - 게임 관리자
├── handlers/
│   ├── __init__.py - 핸들러 초기화 모듈
│   ├── command_handlers.py - 명령어 핸들러
│   ├── callback_handlers.py - 콜백 쿼리 핸들러
│   └── game_handlers.py - 게임 진행 핸들러
├── utils/
│   ├── settings.py - 설정 관리 모듈
│   ├── message_utils.py - 메시지 유틸리티
│   └── state_utils.py - 게임 상태 관리 모듈
├── main.py - 메인 애플리케이션
└── test_bot.py - 테스트 스크립트
```

## 테스트

테스트를 실행하려면 다음 명령어를 사용합니다:

```bash
python -m unittest mafia_bot/test_bot.py
```

## 라이선스

이 프로젝트는 MIT 라이선스 하에 배포됩니다.

## 기여

이슈와 풀 리퀘스트는 환영합니다. 주요 변경 사항은 먼저 이슈를 열어 논의해주세요.
